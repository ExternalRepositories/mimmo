
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="description" content="mimmo is a C++ library for manipulation and morphing surface and volume meshes." />
    <meta name="keywords" content="mimmo, HPC, STL, CGNS, morphing, optimization, radial basis function, free form deformation, mesh, grid" />
    <link rel="shortcut icon" href="/mimmo/images/mimmo_ico.png" type="image/x-icon">
    <link rel="icon" href="/mimmo/images/mimmo_ico.png" type="image/x-icon">
    <link rel='stylesheet' type='text/css' href='http://fonts.googleapis.com/css?family=Lato:400,700'>
    <link rel="stylesheet" type="text/css" href="/mimmo/stylesheets/normalize.css" />
    <link rel="stylesheet" type="text/css" href="/mimmo/stylesheets/base.css" />
    <link rel="stylesheet" type="text/css" href="/mimmo/stylesheets/cookies.css" />
    <script type="text/javascript" src="/mimmo/scripts/jquery-1.12.4.min.js"></script>
    <script type="text/javascript" src="/mimmo/scripts/cookies.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-96644314-1', 'auto');
  ga('send', 'pageview');
</script>
    <script type="text/javascript">
        $(document).ready(function(){
        });
    </script>
    <meta name="generator" content="Doxygen 1.8.5"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="manual.css" rel="stylesheet" type="text/css"/>
    <title>mimmo - Manual - mimmo::bvTreeUtils Namespace Reference</title>
</head>
<body>
<div id="cookie-warning">
        <p id="accept-cookies" class="button">Continue</p>
        <h3>Our website uses cookies</h3>
        <p>
        This website uses cookies. By continuing to use this website you are
        giving consent to cookies being used. For information on cookies
        and how you can disable them visit our
        <a href="/mimmo/privacy.html">Privacy Policy</a>.
        </p>
</div>
<!-- Header-->
<div id="header" class="">
    <div class="logo"><a href="/mimmo">&nbsp;</a></div>
    <div class="menu-line"></div>
<ul class="menu">
    <li>
        <a href="/mimmo/overview">Overview</a>
    </li>
    <li class="current">
        <span>Documentation</span>
        <ul class="sub-menu">
            <li><a href="/mimmo/documentation/installation.html">Installation guide</a></li>
            <li><a href="/mimmo/documentation/manual/1.1.0/index.html">Programmer's manual</a></li>
        </ul>
    </li>
    <li>
        <a href="/mimmo/downloads">Downloads</a>
    </li>
</ul>
<script type="text/javascript">
$('.menu li').hover(
    function() {
        $('ul', this).css('height', 'auto');
        $('ul', this).stop().slideDown(200);
    },
    function() {
        $('ul', this).stop().slideUp(200, function() {
            $(this).attr('style','');
        });
    }
);
</script>
</div>
<div id="content" class="">
<div id="manual">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacemimmo.html">mimmo</a></li><li class="navelem"><a class="el" href="namespacemimmo_1_1bvTreeUtils.html">bvTreeUtils</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mimmo::bvTreeUtils Namespace Reference<div class="ingroups"><a class="el" href="group__core.html">core</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Utilities employing bvTree.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a92e9da11d568d3bcf3ca3cedebdb6105"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1bvTreeUtils.html#a92e9da11d568d3bcf3ca3cedebdb6105">distance</a> (std::array&lt; double, 3 &gt; *P_, <a class="el" href="classmimmo_1_1BvTree.html">BvTree</a> *bvtree_, long &amp;id, double &amp;r, int method, int next, double h)</td></tr>
<tr class="separator:a92e9da11d568d3bcf3ca3cedebdb6105"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60bea809995137b54535cdd75f7116a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__typedefs.html#ga700e3f9fb7ca166ccdae122be74fc91c">dvector1D</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1bvTreeUtils.html#ad60bea809995137b54535cdd75f7116a">distance</a> (std::vector&lt; std::array&lt; double, 3 &gt; &gt; *P_, <a class="el" href="classmimmo_1_1BvTree.html">BvTree</a> *bvtree_, std::vector&lt; long &gt; &amp;id, double r_, int method)</td></tr>
<tr class="separator:ad60bea809995137b54535cdd75f7116a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0416ae8ccc03efa58a993ef3e713f81"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1bvTreeUtils.html#ad0416ae8ccc03efa58a993ef3e713f81">extractTarget</a> (<a class="el" href="classmimmo_1_1BvTree.html">BvTree</a> *target, std::vector&lt; <a class="el" href="classmimmo_1_1BvNode.html">BvNode</a> * &gt; leafSelection, std::vector&lt; long &gt; &amp;extracted, double tol, int next)</td></tr>
<tr class="separator:ad0416ae8ccc03efa58a993ef3e713f81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40dc6bbc4a5aaa894c0af7b7cbbd47ef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__typedefs.html#ga5df63afb31922e8b4ada0a5cc96ad765">darray3E</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1bvTreeUtils.html#a40dc6bbc4a5aaa894c0af7b7cbbd47ef">projectPoint</a> (std::array&lt; double, 3 &gt; *P_, <a class="el" href="classmimmo_1_1BvTree.html">BvTree</a> *bvtree_, double r)</td></tr>
<tr class="separator:a40dc6bbc4a5aaa894c0af7b7cbbd47ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acae25553898362e60e78c4386c57467a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__typedefs.html#ga66d951d058466791a17bc45d019a4442">dvecarr3E</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1bvTreeUtils.html#acae25553898362e60e78c4386c57467a">projectPoint</a> (std::vector&lt; std::array&lt; double, 3 &gt; &gt; *P_, <a class="el" href="classmimmo_1_1BvTree.html">BvTree</a> *bvtree_, double r_)</td></tr>
<tr class="separator:acae25553898362e60e78c4386c57467a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad496d70768532f2f26411ccac45d1720"><td class="memItemLeft" align="right" valign="top">std::vector&lt; long &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1bvTreeUtils.html#ad496d70768532f2f26411ccac45d1720">selectByPatch</a> (<a class="el" href="classmimmo_1_1BvTree.html">BvTree</a> *selection, <a class="el" href="classmimmo_1_1BvTree.html">BvTree</a> *target, double tol)</td></tr>
<tr class="separator:ad496d70768532f2f26411ccac45d1720"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c00e3613272b652de61637cd107d0b2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1bvTreeUtils.html#a0c00e3613272b652de61637cd107d0b2">signedDistance</a> (std::array&lt; double, 3 &gt; *P_, <a class="el" href="classmimmo_1_1BvTree.html">BvTree</a> *bvtree_, long &amp;id, std::array&lt; double, 3 &gt; &amp;n, double &amp;r, int method, bitpit::SurfUnstructured *spatch_, int next, double h)</td></tr>
<tr class="separator:a0c00e3613272b652de61637cd107d0b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a867221d418db12825e8564bdfa32eb1c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__typedefs.html#ga700e3f9fb7ca166ccdae122be74fc91c">dvector1D</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1bvTreeUtils.html#a867221d418db12825e8564bdfa32eb1c">signedDistance</a> (std::vector&lt; std::array&lt; double, 3 &gt; &gt; *P_, <a class="el" href="classmimmo_1_1BvTree.html">BvTree</a> *bvtree_, std::vector&lt; long &gt; &amp;id, std::vector&lt; std::array&lt; double, 3 &gt; &gt; &amp;n, double r_, int method)</td></tr>
<tr class="separator:a867221d418db12825e8564bdfa32eb1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Utilities employing bvTree. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a92e9da11d568d3bcf3ca3cedebdb6105"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double mimmo::bvTreeUtils::distance </td>
          <td>(</td>
          <td class="paramtype">std::array&lt; double, 3 &gt; *&#160;</td>
          <td class="paramname"><em>P_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BvTree *&#160;</td>
          <td class="paramname"><em>bvtree_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long &amp;&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>h</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>It computes the unsigned distance of a point to a geometry linked in a <a class="el" href="classmimmo_1_1BvTree.html" title="Bv-Tree is the class to manage a Bounding Volume Hierarchy tree of a bitpit patch. ">BvTree</a> object. The geometry has to be a surface mesh, in particular an object of type bitpit::SurfUnstructured (a static cast is hardly coded in the method). It searches the element with minimum distance in a box of length 2*r, if none is found return a default value of distance equal to 1.0e+18; </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">P_</td><td>Pointer to coordinates of input point. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bvtree_</td><td>Pointer to Boundary Volume Hierarchy tree that stores the geometry. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">id</td><td>Label of the element found as minimum distance element in the bv-tree. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>Length of the side of the box used to search. (The algorithm checks every element encountered inside the box). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>Length of the side of the box or radius of the sphere used to search. (The algorithm checks every element encountered inside the box/sphere). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">method</td><td>Method used to search the element (0=bounding box, 1=sphere). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">next</td><td>Index of the starting node to perform the searching (optional). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>Initial minimum distance (if no value find below the initial value, this it returns this value as result) (optional). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Unsigned distance of the input point from the patch in the bv-tree. </dd></dl>

<p>Definition at line <a class="el" href="BvTree_8cpp_source.html#l00823">823</a> of file <a class="el" href="BvTree_8cpp_source.html">BvTree.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad60bea809995137b54535cdd75f7116a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; mimmo::bvTreeUtils::distance </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::array&lt; double, 3 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>P_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BvTree *&#160;</td>
          <td class="paramname"><em>bvtree_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; long &gt; &amp;&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>It computes the unsigned distance of a set of points to a geometry linked in a <a class="el" href="classmimmo_1_1BvTree.html" title="Bv-Tree is the class to manage a Bounding Volume Hierarchy tree of a bitpit patch. ">BvTree</a> object. The geometry has to be a surface mesh, in particular an object of type bitpit::SurfUnstructured (a static cast is hardly coded in the method). It searches the elements with minimum distance in a box of length 2*r, if none is found return a default value of distance equal to 1.0e+18; </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">P_</td><td>Pointer to vector with the coordinates of input points. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bvtree_</td><td>Pointer to Boundary Volume Hierarchy tree that stores the geometry. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">id</td><td>Vector with labels of the elements found as minimum distance elements in the bv-tree. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_</td><td>Length of the side of the box or radius of the sphere used to search. (The algorithm checks every element encountered inside the box/sphere). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">method</td><td>Method used to search the element (0=bounding box, 1=sphere). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector with unsigned distances of the input points from the patch in the bv-tree. </dd></dl>

<p>Definition at line <a class="el" href="BvTree_8cpp_source.html#l01013">1013</a> of file <a class="el" href="BvTree_8cpp_source.html">BvTree.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad0416ae8ccc03efa58a993ef3e713f81"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mimmo::bvTreeUtils::extractTarget </td>
          <td>(</td>
          <td class="paramtype">BvTree *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; BvNode * &gt;&#160;</td>
          <td class="paramname"><em>leafSelection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; long &gt; &amp;&#160;</td>
          <td class="paramname"><em>extracted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>next</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>It extracts the elements of a leaf node of geometry stored in a bv-tree by a distance criterion in respect to an other geometry stored in a different bv-tree. It is a recursive method used in selectByPatch method. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">target</td><td>Pointer to bv-tree that store the target geometry. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">leafSelection</td><td>Vector of pointers to the leaf nodes currently interesting for the selection procedure. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">extracted</td><td>of the label of all the elements of the target bv-tree, currently found placed at a distance &lt;= tol from the bounding boxes of the leaf nodes in leafSelection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>Distance threshold used to select the elements of target. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">next</td><td>Index of the node of the bv-tree target to be checked. If the next-th node is not a leaf node the method is recursively called.</td></tr>
  </table>
  </dd>
</dl>
<p>The leafSelection is (potentially) reduced during the procedure by deleting from the vector the nodes that have a distance greater than tol from the bounding volume of the next-th node. </p>

<p>Definition at line <a class="el" href="BvTree_8cpp_source.html#l01110">1110</a> of file <a class="el" href="BvTree_8cpp_source.html">BvTree.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a40dc6bbc4a5aaa894c0af7b7cbbd47ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::array&lt; double, 3 &gt; mimmo::bvTreeUtils::projectPoint </td>
          <td>(</td>
          <td class="paramtype">std::array&lt; double, 3 &gt; *&#160;</td>
          <td class="paramname"><em>P_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BvTree *&#160;</td>
          <td class="paramname"><em>bvtree_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>It computes the projection of a point on a geometry linked in a <a class="el" href="classmimmo_1_1BvTree.html" title="Bv-Tree is the class to manage a Bounding Volume Hierarchy tree of a bitpit patch. ">BvTree</a> object. The geometry has to be a surface mesh, in particular an object of type bitpit::SurfUnstructured (a static cast is hardly coded in the method). It searches the elements of the geometry with minimum distance recursively in a box of length 2*r, by increasing the size r at each step until at least one element is found. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">P_</td><td>Pointer to coordinates of input point. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bvtree_</td><td>Pointer to Boundary Volume Hierarchy tree that stores the geometry. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>Initial length of the side of the box used to search. (The algorithm checks every element encountered inside the box). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Coordinates of the projected point. </dd></dl>

<p>Definition at line <a class="el" href="BvTree_8cpp_source.html#l00946">946</a> of file <a class="el" href="BvTree_8cpp_source.html">BvTree.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="acae25553898362e60e78c4386c57467a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::array&lt; double, 3 &gt; &gt; mimmo::bvTreeUtils::projectPoint </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::array&lt; double, 3 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>P_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BvTree *&#160;</td>
          <td class="paramname"><em>bvtree_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>It computes the projection of a set of points on a geometry linked in a <a class="el" href="classmimmo_1_1BvTree.html" title="Bv-Tree is the class to manage a Bounding Volume Hierarchy tree of a bitpit patch. ">BvTree</a> object. The geometry has to be a surface mesh, in particular an object of type bitpit::SurfUnstructured (a static cast is hardly coded in the method). It searches the elements of the geometry with minimum distance recursively in a box of length 2*r, by increasing the size r at each step until at least one element is found. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">P_</td><td>Pointer to vector with coordinates of input points. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bvtree_</td><td>Pointer to Boundary Volume Hierarchy tree that stores the geometry. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_</td><td>Initial length of the side of the box used to search. (The algorithm checks every element encountered inside the box). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector with coordinates of the projected points. </dd></dl>

<p>Definition at line <a class="el" href="BvTree_8cpp_source.html#l01039">1039</a> of file <a class="el" href="BvTree_8cpp_source.html">BvTree.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad496d70768532f2f26411ccac45d1720"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; long &gt; mimmo::bvTreeUtils::selectByPatch </td>
          <td>(</td>
          <td class="paramtype">BvTree *&#160;</td>
          <td class="paramname"><em>selection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BvTree *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>It selects the elements of a geometry stored in a bv-tree by a distance criterion in respect to an other geometry stored in a different bv-tree. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">selection</td><td>Pointer to bv-tree used as selection patch. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">target</td><td>Pointer to bv-tree that store the target geometry. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>Distance threshold used to select the elements of target. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector of the label of all the elements of the target bv-tree placed at a distance &lt;= tol from the bounding boxes of the leaf nodes of the bv-tree selection. </dd></dl>

<p>Definition at line <a class="el" href="BvTree_8cpp_source.html#l01062">1062</a> of file <a class="el" href="BvTree_8cpp_source.html">BvTree.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0c00e3613272b652de61637cd107d0b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double mimmo::bvTreeUtils::signedDistance </td>
          <td>(</td>
          <td class="paramtype">std::array&lt; double, 3 &gt; *&#160;</td>
          <td class="paramname"><em>P_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BvTree *&#160;</td>
          <td class="paramname"><em>bvtree_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long &amp;&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::array&lt; double, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bitpit::SurfUnstructured *&#160;</td>
          <td class="paramname"><em>spatch_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>h</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>It computes the signed distance of a point to a geometry linked in a <a class="el" href="classmimmo_1_1BvTree.html" title="Bv-Tree is the class to manage a Bounding Volume Hierarchy tree of a bitpit patch. ">BvTree</a> object. The geometry has to be a surface mesh, in particular an object of type bitpit::SurfUnstructured (a static cast is hardly coded in the method). The sign of the distance is provided by the normal to the geometry locally computed. A positive distance means that the point is located, in respect to the surface mesh, on the same side of the outer normal vector. It searches the element with minimum distance in a box of length 2*r, if none is found return a default value of distance equal to 1.0e+18; </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">P_</td><td>Pointer to coordinates of input point. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bvtree_</td><td>Pointer to Boundary Volume Hierarchy tree that stores the geometry. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">id</td><td>Label of the element found as minimum distance element in the bv-tree. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">n</td><td>Pseudo-normal of the element (i.e. unit vector with direction (P-xP), where P is the input point and xP the nearest point on the element (simplex) to the projection of P on the plane of the simplex. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>Length of the side of the box or radius of the sphere used to search. (The algorithm checks every element encountered inside the box/sphere). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">method</td><td>Method used to search the element (0=bounding box, 1=sphere). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">spatch_</td><td>Pointer to bitpit::SurfUnstructured patch related to the bv-tree (optional). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">next</td><td>Index of the starting node to perform the searching (optional). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>Initial minimum distance (if no value find below the initial value, this it returns this value as result) (optional). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Signed distance of the input point from the patch in the bv-tree. </dd></dl>

<p>Definition at line <a class="el" href="BvTree_8cpp_source.html#l00620">620</a> of file <a class="el" href="BvTree_8cpp_source.html">BvTree.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a867221d418db12825e8564bdfa32eb1c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; mimmo::bvTreeUtils::signedDistance </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::array&lt; double, 3 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>P_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BvTree *&#160;</td>
          <td class="paramname"><em>bvtree_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; long &gt; &amp;&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::array&lt; double, 3 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>It computes the signed distance of a set of points to a geometry linked in a <a class="el" href="classmimmo_1_1BvTree.html" title="Bv-Tree is the class to manage a Bounding Volume Hierarchy tree of a bitpit patch. ">BvTree</a> object. The geometry has to be a surface mesh, in particular an object of type bitpit::SurfUnstructured (a static cast is hardly coded in the method). The sign of the distance is provided by the normal to the geometry locally computed. A positive distance means that a point is located, in respect to the surface mesh, on the same side of the outer normal vector. It searches the elements with minimum distance in a box of length 2*r, if none is found return a default value of distance equal to 1.0e+18; </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">P_</td><td>Pointer to a vector with the coordinates of input points. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bvtree_</td><td>Pointer to Boundary Volume Hierarchy tree that stores the geometry. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">id</td><td>Vector of labels of the elements found as minimum distance elements in the bv-tree. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">n</td><td>Vector of pseudo-normals of the elements (i.e. unit vectors with direction (P-xP), where P is an input point and xP the nearest point on the element (simplex) to the projection of P on the plane of the simplex. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_</td><td>Length of the side of the box or radius of the sphere used to search. (The algorithm checks every element encountered inside the box/sphere). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">method</td><td>Method used to search the element (0=bounding box, 1=sphere). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector with signed distances of the input points from the patch in the bv-tree. </dd></dl>

<p>Definition at line <a class="el" href="BvTree_8cpp_source.html#l00985">985</a> of file <a class="el" href="BvTree_8cpp_source.html">BvTree.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->

</div>
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<address class="footer"><small>
Generated on Wed Jun 7 2017 12:26:06 for mimmo by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
    <div id="footer" >
        <div class="middle">
            <div class="box-wrapper">
                <div class="box mimmo">
                    <p>
                    <strong><a href="/mimmo">mimmo</a></strong><br />
                    <a href="/mimmo/overview">Overview</a><br />
                    <a href="/mimmo/downloads">Downloads</a>
                    </p>
                </div>
                <div class="box optimad">
                    <p>
                    <strong><a href="http://www.optimad.it">OPTIMAD Engineering Srl</a></strong><br />
                    <a href="http://www.optimad.it/corporate/spin-off/">About</a><br />
                    <a href="http://www.optimad.it/contact-us/">Contact us</a><br />
                    <a href="mailto:info@optimad.it">info@optimad.it</a>
                    </p>
                </div>
                <div class="box address">
                    <p>
                    <strong>Address</strong><br />
                    Via Giacinto Collegno 18<br />
                    10143 Torino<br />
                    Italy
                    </p>
                </div>
                <div class="box info">
                    <p>
                    <strong>Info</strong><br />
                    Capitale Sociale € 10.000,00 i.v.<br />
                    C.F. / P.Iva 09359170017<br />
                    Iscr. Reg. Impr. Torino - R.E.A. TO-1045102
                    </p>
                </div>
            </div>
        </div>
        <div class="legal">
                    <p>
                    © 2016-2017 OPTIMAD Engineering Srl -
                    <a href="/mimmo/privacy.html">Privacy Policy</a>
                    </p>
        </div>
    </div>
</div>
</body>
</html>

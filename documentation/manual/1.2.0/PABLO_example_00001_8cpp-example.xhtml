
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="description" content="bitpit is a C++ library for scientific High Performance Computing." />
    <meta name="keywords" content="bitpit, HPC, octree, PABLO, levelset, RBF, mesh, grid" />
    <link rel="shortcut icon" href="/bitpit-private/images/bitpit_icon.ico" type="image/vnd.microsoft.icon" />
    <link rel="stylesheet" type="text/css" href="/bitpit-private/stylesheets/normalize.css" />
    <link rel="stylesheet" type="text/css" href="/bitpit-private/stylesheets/base.css" />
    <link rel="stylesheet" type="text/css" href="/bitpit-private/stylesheets/slideshow.css" />
    <script type="text/javascript" src="/bitpit-private/scripts/jquery-1.12.4.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
        });
    </script>
    <meta name="generator" content="Doxygen 1.8.5"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="manual.css" rel="stylesheet" type="text/css"/>
    <title>bitpit - Manual - PABLO_example_00001.cpp</title>
</head>
<body>
<!-- Header-->
<div id="header" class="">
    <div class="logo"><a href="/bitpit-private">bitpit</a></div>
    <div class="menu-line"></div>
<ul class="menu">
    <li>
        <span>Modules</span>
        <ul class="sub-menu">
            <li><a href="/bitpit-private/modules/overview.html">Overview</a></li>
            <li><a href="/bitpit-private/modules/PABLO.html">PABLO</a></li>
            <li><a href="/bitpit-private/modules/RBF.html">RBF</a></li>
        </ul>
    </li>
    <li>
        <a href="/bitpit-private/examples">Examples</a>
    </li>
    <li class="current">
        <span>Documentation</span>
        <ul class="sub-menu">
            <li><a href="/bitpit-private/documentation/installation.html">Installation guide</a></li>
            <li><a href="/bitpit-private/documentation/manual/1.2.0/index.xhtml">Programmer's manual</a></li>
        </ul>
    </li>
    <li>
        <a href="/bitpit-private/downloads">Downloads</a>
    </li>
</ul>
<script type="text/javascript">
$('.menu li').hover(
    function() {
        $('ul', this).css('height', 'auto');
        $('ul', this).stop().slideDown(200);
    },
    function() {
        $('ul', this).stop().slideUp(200, function() {
            $(this).attr('style','');
        });
    }
);
</script>
</div>
<div id="content" class="">
<div id="manual">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.xhtml"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.xhtml"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.xhtml"><span>Modules</span></a></li>
      <li><a href="namespaces.xhtml"><span>Namespaces</span></a></li>
      <li><a href="annotated.xhtml"><span>Classes</span></a></li>
      <li><a href="files.xhtml"><span>Files</span></a></li>
      <li><a href="examples.xhtml"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">PABLO_example_00001.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>2D adaptive mesh refinement (AMR) using PABLOThis example creates a 2D Octree mesh on the square domain [0,1]x[0,1].</p>
<p>The domain is refined globally one time, then refined iteratively using two different refinement criteria. At the end of the iterative refinement, one global refinement is performed again.</p>
<p>In the first criterion, each octant generated by a previous refinement iteration is marked for further refinement if its center is within a circle with a specified radius. Iterative refinement stops when a fixed number of iteration is reached.</p>
<p>In the second criterion, the refinement is performed using the same rules of the first criterion. However, this refinement is performed until the flag returned by the adapt method is true (for further details about adapt method, please visit documentation). Video below illustrates the iterative refinement. Each frame show the result of a refinement iteration starting from the ancestor quadrant up to the last global refinement.</p>
<p>The upper part of the domain is adapted by a refinement procedure using the first criterion, while the bottom part by a refinement procedure using the second criterion.</p>
<p>Moreover, in the right hand side of the domain, the 2:1 balancing is deactivated.</p>
<p><b>To run</b>: ./PABLO_example_00001 <br/>
 <b>To see the result visit</b>: <a href="http://optimad.github.io/PABLO/">PABLO website</a> <br/>
 </p>
<div class="fragment"><div class="line"><span class="comment">/*---------------------------------------------------------------------------*\</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  bitpit</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  Copyright (C) 2015-2016 OPTIMAD engineering Srl</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  -------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"> *  License</span></div>
<div class="line"><span class="comment"> *  This file is part of bitbit.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  bitpit is free software: you can redistribute it and/or modify it</span></div>
<div class="line"><span class="comment"> *  under the terms of the GNU Lesser General Public License v3 (LGPL)</span></div>
<div class="line"><span class="comment"> *  as published by the Free Software Foundation.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  bitpit is distributed in the hope that it will be useful, but WITHOUT</span></div>
<div class="line"><span class="comment"> *  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div>
<div class="line"><span class="comment"> *  FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public</span></div>
<div class="line"><span class="comment"> *  License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> *  along with bitpit. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment">\*---------------------------------------------------------------------------*/</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;bitpit_PABLO.hpp&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">using namespace </span>std;</div>
<div class="line"><span class="keyword">using namespace </span>bitpit;</div>
<div class="line"></div>
<div class="line"><span class="comment">// =================================================================================== //</span></div>
<div class="line"><span class="comment"></span><span class="comment">// =================================================================================== //</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if BITPIT_ENABLE_MPI==1</span></div>
<div class="line"><span class="preprocessor"></span>    MPI_Init(&amp;argc, &amp;argv);</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">        <span class="keywordtype">int</span> nproc;</div>
<div class="line">        <span class="keywordtype">int</span> rank;</div>
<div class="line"><span class="preprocessor">#if BITPIT_ENABLE_MPI==1</span></div>
<div class="line"><span class="preprocessor"></span>        MPI_Comm comm = MPI_COMM_WORLD;</div>
<div class="line">        MPI_Comm_size(comm,&amp;nproc);</div>
<div class="line">        MPI_Comm_rank(comm,&amp;rank);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"></span>        nproc = 1;</div>
<div class="line">        rank = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>        log::manager().initialize(log::SEPARATE, <span class="keyword">false</span>, nproc, rank);</div>
<div class="line">        log::cout() &lt;&lt; <a class="code" href="namespacebitpit_1_1log.xhtml#acd50005e81bd303fa96065d563592348">fileVerbosity</a>(log::NORMAL);</div>
<div class="line">        log::cout() &lt;&lt; <a class="code" href="namespacebitpit_1_1log.xhtml#ad6f89bcb2adf0f51cb232969b714e83b">consoleVerbosity</a>(log::QUIET);</div>
<div class="line"></div>
<div class="line">        <a name="_a0"></a><a class="code" href="classbitpit_1_1PabloUniform.xhtml">PabloUniform</a> pablo1;</div>
<div class="line"></div>
<div class="line">        pablo1.<a name="a1"></a><a class="code" href="classbitpit_1_1ParaTree.xhtml#a41d99b9833493d8b18bf927418bf7598">computeConnectivity</a>();</div>
<div class="line">        pablo1.<a name="a2"></a><a class="code" href="classbitpit_1_1ParaTree.xhtml#a6c576c6c980921e595e20990beda63b2">write</a>(<span class="stringliteral">&quot;pablo00001_iter0&quot;</span>);</div>
<div class="line"></div>
<div class="line">        pablo1.<a name="a3"></a><a class="code" href="classbitpit_1_1ParaTree.xhtml#a5eacb88f2324b915ba8dbac95c994755">adaptGlobalRefine</a>();</div>
<div class="line">        pablo1.<a name="a4"></a><a class="code" href="classbitpit_1_1ParaTree.xhtml#ab4aa4521f6f8b2c046ad2bcb57bf568d">updateConnectivity</a>();</div>
<div class="line">        pablo1.<a class="code" href="classbitpit_1_1ParaTree.xhtml#a6c576c6c980921e595e20990beda63b2">write</a>(<span class="stringliteral">&quot;pablo00001_iter1&quot;</span>);</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> xc, yc;</div>
<div class="line">        xc = yc = 0.5;</div>
<div class="line"></div>
<div class="line">        pablo1.<a name="a5"></a><a class="code" href="classbitpit_1_1ParaTree.xhtml#a83692f2c0bc7b6097d38fc8ac61be5fd">setBalanceCodimension</a>(1);</div>
<div class="line"></div>
<div class="line">        uint32_t nocts = pablo1.<a name="a6"></a><a class="code" href="classbitpit_1_1ParaTree.xhtml#aedea46c7857bffcebb567995285d40db">getNumOctants</a>();</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;nocts; i++){</div>
<div class="line">            array&lt;double,3&gt; center = pablo1.<a name="a7"></a><a class="code" href="classbitpit_1_1PabloUniform.xhtml#ab4d8b1dc243f613f68eedc38a941cef2">getCenter</a>(i);</div>
<div class="line">            <span class="keywordtype">double</span> x = center[0];</div>
<div class="line">            <span class="keywordflow">if</span> (x&gt;xc)</div>
<div class="line">                pablo1.<a name="a8"></a><a class="code" href="classbitpit_1_1ParaTree.xhtml#adb875937b6ccc0473c48b66b73bf13d9">setBalance</a>(i,<span class="keyword">false</span>);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> radius = 0.4;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> nref1 = 6;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iter=0; iter&lt;nref1; iter++){</div>
<div class="line">            nocts = pablo1.<a class="code" href="classbitpit_1_1ParaTree.xhtml#aedea46c7857bffcebb567995285d40db">getNumOctants</a>();</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;nocts; i++){</div>
<div class="line">                <a name="_a9"></a><a class="code" href="classbitpit_1_1Octant.xhtml">Octant</a> *oct = pablo1.<a name="a10"></a><a class="code" href="classbitpit_1_1ParaTree.xhtml#a2eff54ce1a781fe3844e6bcc698a03bc">getOctant</a>(i);</div>
<div class="line">                array&lt;double,3&gt; center = pablo1.<a class="code" href="classbitpit_1_1PabloUniform.xhtml#ab4d8b1dc243f613f68eedc38a941cef2">getCenter</a>(oct);</div>
<div class="line">                <span class="keywordtype">double</span> x = center[0];</div>
<div class="line">                <span class="keywordtype">double</span> y = center[1];</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> ((<a name="a11"></a><a class="code" href="group__MathFunctions.xhtml#ga6da0697577be6fda9b574b2344c58014">pow</a>((x-xc),2.0)+<a class="code" href="group__MathFunctions.xhtml#ga6da0697577be6fda9b574b2344c58014">pow</a>((y-yc),2.0) &lt; <a class="code" href="group__MathFunctions.xhtml#ga6da0697577be6fda9b574b2344c58014">pow</a>(radius,2.0)) &amp;&amp;</div>
<div class="line">                        (y&lt;yc)){</div>
<div class="line">                    pablo1.<a name="a12"></a><a class="code" href="classbitpit_1_1ParaTree.xhtml#a0d210b4659cca3b083f6f07aa30577a7">setMarker</a>(oct, 1);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            pablo1.<a name="a13"></a><a class="code" href="classbitpit_1_1ParaTree.xhtml#a234a7e3bb6fdb72c14d6cdcaafda8395">adapt</a>();</div>
<div class="line">            pablo1.<a class="code" href="classbitpit_1_1ParaTree.xhtml#ab4aa4521f6f8b2c046ad2bcb57bf568d">updateConnectivity</a>();</div>
<div class="line">            pablo1.<a class="code" href="classbitpit_1_1ParaTree.xhtml#a6c576c6c980921e595e20990beda63b2">write</a>(<span class="stringliteral">&quot;pablo00001_iter&quot;</span>+to_string(static_cast&lt;unsigned long long&gt;(iter+2)));</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> nref2 = 5;</div>
<div class="line">        <span class="keywordtype">int</span> iter = 0;</div>
<div class="line">        <span class="keywordtype">bool</span> done = <span class="keyword">true</span>;</div>
<div class="line">        <span class="keywordflow">while</span>(iter&lt;=nref2){</div>
<div class="line">            done = <span class="keyword">true</span>;</div>
<div class="line">            <span class="keywordflow">while</span>(done)</div>
<div class="line">            {</div>
<div class="line">                nocts = pablo1.<a class="code" href="classbitpit_1_1ParaTree.xhtml#aedea46c7857bffcebb567995285d40db">getNumOctants</a>();</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;nocts; i++){</div>
<div class="line">                    array&lt;double,3&gt; center = pablo1.<a class="code" href="classbitpit_1_1PabloUniform.xhtml#ab4d8b1dc243f613f68eedc38a941cef2">getCenter</a>(i);</div>
<div class="line">                    <span class="keywordtype">double</span> x = center[0];</div>
<div class="line">                    <span class="keywordtype">double</span> y = center[1];</div>
<div class="line">                    <span class="keywordflow">if</span> ((<a class="code" href="group__MathFunctions.xhtml#ga6da0697577be6fda9b574b2344c58014">pow</a>((x-xc),2.0)+<a class="code" href="group__MathFunctions.xhtml#ga6da0697577be6fda9b574b2344c58014">pow</a>((y-yc),2.0) &lt; <a class="code" href="group__MathFunctions.xhtml#ga6da0697577be6fda9b574b2344c58014">pow</a>(radius,2.0)) &amp;&amp;</div>
<div class="line">                            (y&gt;yc) &amp;&amp; iter&lt;=nref2 &amp;&amp; pablo1.<a name="a14"></a><a class="code" href="classbitpit_1_1ParaTree.xhtml#a6ffebc73d993ac8711c0efc04435d944">getLevel</a>(i)&lt;=iter+1){</div>
<div class="line"></div>
<div class="line">                        pablo1.<a class="code" href="classbitpit_1_1ParaTree.xhtml#a0d210b4659cca3b083f6f07aa30577a7">setMarker</a>(i, 1);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">                done = pablo1.<a class="code" href="classbitpit_1_1ParaTree.xhtml#a234a7e3bb6fdb72c14d6cdcaafda8395">adapt</a>();</div>
<div class="line">                pablo1.<a class="code" href="classbitpit_1_1ParaTree.xhtml#ab4aa4521f6f8b2c046ad2bcb57bf568d">updateConnectivity</a>();</div>
<div class="line">                pablo1.<a class="code" href="classbitpit_1_1ParaTree.xhtml#a6c576c6c980921e595e20990beda63b2">write</a>(<span class="stringliteral">&quot;pablo00001_iter&quot;</span>+to_string(static_cast&lt;unsigned long long&gt;(iter+nref1+2)));</div>
<div class="line">            }</div>
<div class="line">            iter++;</div>
<div class="line">        }</div>
<div class="line">        pablo1.<a class="code" href="classbitpit_1_1ParaTree.xhtml#a5eacb88f2324b915ba8dbac95c994755">adaptGlobalRefine</a>();</div>
<div class="line">        pablo1.<a class="code" href="classbitpit_1_1ParaTree.xhtml#ab4aa4521f6f8b2c046ad2bcb57bf568d">updateConnectivity</a>();</div>
<div class="line">        pablo1.<a class="code" href="classbitpit_1_1ParaTree.xhtml#a6c576c6c980921e595e20990beda63b2">write</a>(<span class="stringliteral">&quot;pablo00001_iter&quot;</span>+to_string(static_cast&lt;unsigned long long&gt;(iter+nref1+3)));</div>
<div class="line"><span class="preprocessor">#if BITPIT_ENABLE_MPI==1</span></div>
<div class="line"><span class="preprocessor"></span>    }</div>
<div class="line"></div>
<div class="line">    MPI_Finalize();</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>}</div>
</div><!-- fragment --> </div><!-- contents -->

</div>
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<address class="footer"><small>
Generated on Mon Jul 18 2016 09:46:23 for bitpit by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
    <div id="footer" >
        <p><strong>OPTIMAD Engineering Srl</strong> - Via Giacinto Collegno 18 - 10143 Torino</p>
        <p>Capitale Sociale euro 10.000,00 i.v. - Iscr. Reg. Impr. Torino C.F. / P.Iva 09359170017 - R.E.A. TO-1045102</p>
        <p><a href="/bitpit-private/privacy.html">Privacy Policy</a></p>
    </div>
</div>
</body>
</html>

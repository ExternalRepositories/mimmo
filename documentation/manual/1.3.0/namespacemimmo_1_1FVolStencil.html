
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="description" content="mimmo is a C++ library for manipulation and morphing surface and volume meshes." />
    <meta name="keywords" content="mimmo, HPC, STL, CGNS, morphing, optimization, radial basis function, free form deformation, mesh, grid" />
    <link rel="shortcut icon" href="/mimmo/images/mimmo_ico.png" type="image/x-icon">
    <link rel="icon" href="/mimmo/images/mimmo_ico.png" type="image/x-icon">
    <link rel='stylesheet' type='text/css' href='http://fonts.googleapis.com/css?family=Lato:400,700'>
    <link rel="stylesheet" type="text/css" href="/mimmo/stylesheets/normalize.css" />
    <link rel="stylesheet" type="text/css" href="/mimmo/stylesheets/base.css" />
    <link rel="stylesheet" type="text/css" href="/mimmo/stylesheets/cookies.css" />
    <script type="text/javascript" src="/mimmo/scripts/jquery-1.12.4.min.js"></script>
    <script type="text/javascript" src="/mimmo/scripts/cookies.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-96644314-1', 'auto');
  ga('send', 'pageview');
</script>
    <script type="text/javascript">
        $(document).ready(function(){
        });
    </script>
    <meta name="generator" content="Doxygen 1.8.13"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="manual.css" rel="stylesheet" type="text/css"/>
    <title>mimmo - Manual - mimmo::FVolStencil Namespace Reference</title>
</head>
<body>
<div id="cookie-warning">
        <p id="accept-cookies" class="button">Continue</p>
        <h3>Our website uses cookies</h3>
        <p>
        This website uses cookies. By continuing to use this website you are
        giving consent to cookies being used. For information on cookies
        and how you can disable them visit our
        <a href="/mimmo/privacy.html">Privacy Policy</a>.
        </p>
</div>
<!-- Header-->
<div id="header" class="">
    <div class="logo"><a href="/mimmo">&nbsp;</a></div>
    <div class="menu-line"></div>
<ul class="menu">
    <li>
        <a href="/mimmo/overview">Overview</a>
    </li>
    <li class="current">
        <span>Documentation</span>
        <ul class="sub-menu">
            <li><a href="/mimmo/documentation/installation.html">Installation guide</a></li>
            <li><a href="/mimmo/documentation/manual/1.3.0/index.html">Programmer's manual</a></li>
        </ul>
    </li>
    <li>
        <a href="/mimmo/downloads">Downloads</a>
    </li>
</ul>
<script type="text/javascript">
$('.menu li').hover(
    function() {
        $('ul', this).css('height', 'auto');
        $('ul', this).stop().slideDown(200);
    },
    function() {
        $('ul', this).stop().slideUp(200, function() {
            $(this).attr('style','');
        });
    }
);
</script>
</div>
<div id="content" class="">
<div id="manual">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>mimmo</b></li><li class="navelem"><a class="el" href="namespacemimmo_1_1FVolStencil.html">FVolStencil</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mimmo::FVolStencil Namespace Reference<div class="ingroups"><a class="el" href="group__propagators.html">propagators</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Collection of methods to precompute stencils of math operators (Laplacian, Gradients, etc...) on mimmo meshes for finite volumes methods.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a28a7defa543450d91fb2b4a00934589a"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classmimmo_1_1MimmoPiercedVector.html">MimmoPiercedVector</a>&lt; bitpit::StencilScalar &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1FVolStencil.html#a28a7defa543450d91fb2b4a00934589a">MPVDivergence</a></td></tr>
<tr class="separator:a28a7defa543450d91fb2b4a00934589a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee59416f10fdab9bcd552d407fdfca92"><td class="memItemLeft" align="right" valign="top">typedef std::unique_ptr&lt; <a class="el" href="namespacemimmo_1_1FVolStencil.html#a28a7defa543450d91fb2b4a00934589a">MPVDivergence</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1FVolStencil.html#aee59416f10fdab9bcd552d407fdfca92">MPVDivergenceUPtr</a></td></tr>
<tr class="separator:aee59416f10fdab9bcd552d407fdfca92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97dd756771ac3f3f748e9dda157ba9ff"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classmimmo_1_1MimmoPiercedVector.html">MimmoPiercedVector</a>&lt; bitpit::StencilVector &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1FVolStencil.html#a97dd756771ac3f3f748e9dda157ba9ff">MPVGradient</a></td></tr>
<tr class="separator:a97dd756771ac3f3f748e9dda157ba9ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb0e8db7d8924009c16d9034c706805f"><td class="memItemLeft" align="right" valign="top">typedef std::unique_ptr&lt; <a class="el" href="namespacemimmo_1_1FVolStencil.html#a97dd756771ac3f3f748e9dda157ba9ff">MPVGradient</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1FVolStencil.html#adb0e8db7d8924009c16d9034c706805f">MPVGradientUPtr</a></td></tr>
<tr class="separator:adb0e8db7d8924009c16d9034c706805f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a98064c407540cdb12af3ebffa501357e"><td class="memItemLeft" align="right" valign="top">bitpit::StencilVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1FVolStencil.html#a98064c407540cdb12af3ebffa501357e">computeBorderFaceGradient</a> (const std::array&lt; double, 3 &gt; &amp;interfaceNormal, const bitpit::StencilVector &amp;CCellOwnerStencil)</td></tr>
<tr class="separator:a98064c407540cdb12af3ebffa501357e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b0337e69afa97e8a7a19b9120340bc4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemimmo_1_1FVolStencil.html#adb0e8db7d8924009c16d9034c706805f">MPVGradientUPtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1FVolStencil.html#a5b0337e69afa97e8a7a19b9120340bc4">computeFVCellGradientStencil</a> (<a class="el" href="classmimmo_1_1MimmoObject.html">MimmoObject</a> &amp;geo, const std::vector&lt; long &gt; *updatelist)</td></tr>
<tr class="separator:a5b0337e69afa97e8a7a19b9120340bc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab94dd08338a347d9bf0828f84e50c868"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemimmo_1_1FVolStencil.html#adb0e8db7d8924009c16d9034c706805f">MPVGradientUPtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1FVolStencil.html#ab94dd08338a347d9bf0828f84e50c868">computeFVFaceGradientStencil</a> (<a class="el" href="classmimmo_1_1MimmoObject.html">MimmoObject</a> &amp;geo, <a class="el" href="namespacemimmo_1_1FVolStencil.html#a97dd756771ac3f3f748e9dda157ba9ff">MPVGradient</a> *cellGradientStencil)</td></tr>
<tr class="separator:ab94dd08338a347d9bf0828f84e50c868"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c8df20fff0787ebd5a697c4a952a5a4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemimmo_1_1FVolStencil.html#aee59416f10fdab9bcd552d407fdfca92">MPVDivergenceUPtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1FVolStencil.html#a5c8df20fff0787ebd5a697c4a952a5a4">computeFVLaplacianStencil</a> (<a class="el" href="namespacemimmo_1_1FVolStencil.html#a97dd756771ac3f3f748e9dda157ba9ff">MPVGradient</a> &amp;faceGradientStencil, double tolerance, <a class="el" href="classmimmo_1_1MimmoPiercedVector.html">MimmoPiercedVector</a>&lt; double &gt; *diffusivity)</td></tr>
<tr class="separator:a5c8df20fff0787ebd5a697c4a952a5a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f2b66f99a550ac2dde44405319e4114"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1FVolStencil.html#a4f2b66f99a550ac2dde44405319e4114">computeWeightsWLS</a> (const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;P, const std::vector&lt; double &gt; &amp;w, std::vector&lt; std::vector&lt; double &gt;&gt; *gweights)</td></tr>
<tr class="separator:a4f2b66f99a550ac2dde44405319e4114"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5199096f02206856a7aec98869bfadf"><td class="memItemLeft" align="right" valign="top">bitpit::StencilVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1FVolStencil.html#aa5199096f02206856a7aec98869bfadf">correctionDirichletBCFaceGradient</a> (const double &amp;dirval, const long &amp;ownerID, const std::array&lt; double, 3 &gt; &amp;ownerCentroid, const std::array&lt; double, 3 &gt; &amp;interfaceCentroid, const std::array&lt; double, 3 &gt; &amp;interfaceNormal, const double &amp;distD, const bitpit::StencilVector &amp;CCellOwnerStencil)</td></tr>
<tr class="separator:aa5199096f02206856a7aec98869bfadf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc151410157be4d5dc4d4bf6bbb13aa1"><td class="memItemLeft" align="right" valign="top">bitpit::StencilVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1FVolStencil.html#afc151410157be4d5dc4d4bf6bbb13aa1">correctionNeumannBCFaceGradient</a> (const double &amp;neuval, const std::array&lt; double, 3 &gt; &amp;interfaceNormal)</td></tr>
<tr class="separator:afc151410157be4d5dc4d4bf6bbb13aa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49988f33f6cfd083eb6251a621446662"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemimmo_1_1FVolStencil.html#adb0e8db7d8924009c16d9034c706805f">MPVGradientUPtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1FVolStencil.html#a49988f33f6cfd083eb6251a621446662">updateFVFaceGradientStencil</a> (<a class="el" href="classmimmo_1_1MimmoObject.html">MimmoObject</a> &amp;geo, const std::vector&lt; long &gt; &amp;list)</td></tr>
<tr class="separator:a49988f33f6cfd083eb6251a621446662"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb978fddb1717c411f7be2727217580e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacemimmo_1_1FVolStencil.html#adb0e8db7d8924009c16d9034c706805f">MPVGradientUPtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemimmo_1_1FVolStencil.html#abb978fddb1717c411f7be2727217580e">updateFVFaceGradientStencil</a> (<a class="el" href="classmimmo_1_1MimmoObject.html">MimmoObject</a> &amp;geo, <a class="el" href="namespacemimmo_1_1FVolStencil.html#a97dd756771ac3f3f748e9dda157ba9ff">MPVGradient</a> &amp;cellGradientStencil)</td></tr>
<tr class="separator:abb978fddb1717c411f7be2727217580e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Collection of methods to precompute stencils of math operators (Laplacian, Gradients, etc...) on mimmo meshes for finite volumes methods. </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="a28a7defa543450d91fb2b4a00934589a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28a7defa543450d91fb2b4a00934589a">&#9670;&nbsp;</a></span>MPVDivergence</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classmimmo_1_1MimmoPiercedVector.html">MimmoPiercedVector</a>&lt;bitpit::StencilScalar&gt; <a class="el" href="namespacemimmo_1_1FVolStencil.html#a28a7defa543450d91fb2b4a00934589a">mimmo::FVolStencil::MPVDivergence</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>typedef to save stencil of Div stuff </p>

<p class="definition">Definition at line <a class="el" href="StencilFunctions_8hpp_source.html#l00041">41</a> of file <a class="el" href="StencilFunctions_8hpp_source.html">StencilFunctions.hpp</a>.</p>

</div>
</div>
<a id="aee59416f10fdab9bcd552d407fdfca92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee59416f10fdab9bcd552d407fdfca92">&#9670;&nbsp;</a></span>MPVDivergenceUPtr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::unique_ptr&lt; <a class="el" href="namespacemimmo_1_1FVolStencil.html#a28a7defa543450d91fb2b4a00934589a">MPVDivergence</a> &gt; <a class="el" href="namespacemimmo_1_1FVolStencil.html#aee59416f10fdab9bcd552d407fdfca92">mimmo::FVolStencil::MPVDivergenceUPtr</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>typedef to instantiate unique ptr of Div stencil </p>

<p class="definition">Definition at line <a class="el" href="StencilFunctions_8hpp_source.html#l00043">43</a> of file <a class="el" href="StencilFunctions_8hpp_source.html">StencilFunctions.hpp</a>.</p>

</div>
</div>
<a id="a97dd756771ac3f3f748e9dda157ba9ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97dd756771ac3f3f748e9dda157ba9ff">&#9670;&nbsp;</a></span>MPVGradient</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classmimmo_1_1MimmoPiercedVector.html">MimmoPiercedVector</a>&lt;bitpit::StencilVector&gt; <a class="el" href="namespacemimmo_1_1FVolStencil.html#a97dd756771ac3f3f748e9dda157ba9ff">mimmo::FVolStencil::MPVGradient</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>typedef to save stencil of a Grad stuff </p>

<p class="definition">Definition at line <a class="el" href="StencilFunctions_8hpp_source.html#l00040">40</a> of file <a class="el" href="StencilFunctions_8hpp_source.html">StencilFunctions.hpp</a>.</p>

</div>
</div>
<a id="adb0e8db7d8924009c16d9034c706805f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb0e8db7d8924009c16d9034c706805f">&#9670;&nbsp;</a></span>MPVGradientUPtr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::unique_ptr&lt; <a class="el" href="namespacemimmo_1_1FVolStencil.html#a97dd756771ac3f3f748e9dda157ba9ff">MPVGradient</a> &gt; <a class="el" href="namespacemimmo_1_1FVolStencil.html#adb0e8db7d8924009c16d9034c706805f">mimmo::FVolStencil::MPVGradientUPtr</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>typedef to instantiate unique ptr of Grad stencil </p>

<p class="definition">Definition at line <a class="el" href="StencilFunctions_8hpp_source.html#l00042">42</a> of file <a class="el" href="StencilFunctions_8hpp_source.html">StencilFunctions.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a98064c407540cdb12af3ebffa501357e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98064c407540cdb12af3ebffa501357e">&#9670;&nbsp;</a></span>computeBorderFaceGradient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bitpit::StencilVector mimmo::FVolStencil::computeBorderFaceGradient </td>
          <td>(</td>
          <td class="paramtype">const std::array&lt; double, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>interfaceNormal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bitpit::StencilVector &amp;&#160;</td>
          <td class="paramname"><em>CCellOwnerStencil</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Evaluate the Gradient Stencil at a generic Boundary Interface using a homogeneous Neumann condition. The method corrects a CenterCell Gradient Stencil referred to the Owner cell of the interface, erasing the cell gradient normal part to the interface and substituting it with a zero onstant part</p>
<p>Please note, you can impose your right boundary condition later adding an opportune correction (a real prediction of the normal part). see correctionNeumannBCFaceGradient or correctionDirichletBCFaceGradient</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">interfaceNormal</td><td>normal defined on the BoundaryInterface </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CCellOwnerStencil</td><td>cell gradient stencil referred to the owner cell </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the homogeneous neumann border stencil. </dd></dl>

<p class="definition">Definition at line <a class="el" href="StencilFunctions_8cpp_source.html#l00390">390</a> of file <a class="el" href="StencilFunctions_8cpp_source.html">StencilFunctions.cpp</a>.</p>

</div>
</div>
<a id="a5b0337e69afa97e8a7a19b9120340bc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b0337e69afa97e8a7a19b9120340bc4">&#9670;&nbsp;</a></span>computeFVCellGradientStencil()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemimmo_1_1FVolStencil.html#adb0e8db7d8924009c16d9034c706805f">MPVGradientUPtr</a> mimmo::FVolStencil::computeFVCellGradientStencil </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmimmo_1_1MimmoObject.html">MimmoObject</a> &amp;&#160;</td>
          <td class="paramname"><em>geo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; long &gt; *&#160;</td>
          <td class="paramname"><em>updatelist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Evaluate the gradient Stencil on Center Cell for <a class="el" href="classmimmo_1_1MimmoObject.html" title="MimmoObject is the basic geometry container for mimmo library. ">MimmoObject</a> Volume mesh (type 2). Internally, it employs a Least Squared method to get the correct weights of the gradient. The method assumes target mesh has adjacencies already built: no check is performed in this sense.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">geo</td><td>target mesh </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">updatelist</td><td>(optional) if not null, perform computation only on the cell listed, if null compute on all cells. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a CELL data pierced vector containing the gradient stencils </dd></dl>

<p class="definition">Definition at line <a class="el" href="StencilFunctions_8cpp_source.html#l00125">125</a> of file <a class="el" href="StencilFunctions_8cpp_source.html">StencilFunctions.cpp</a>.</p>

</div>
</div>
<a id="ab94dd08338a347d9bf0828f84e50c868"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab94dd08338a347d9bf0828f84e50c868">&#9670;&nbsp;</a></span>computeFVFaceGradientStencil()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemimmo_1_1FVolStencil.html#adb0e8db7d8924009c16d9034c706805f">MPVGradientUPtr</a> mimmo::FVolStencil::computeFVFaceGradientStencil </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmimmo_1_1MimmoObject.html">MimmoObject</a> &amp;&#160;</td>
          <td class="paramname"><em>geo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacemimmo_1_1FVolStencil.html#a97dd756771ac3f3f748e9dda157ba9ff">MPVGradient</a> *&#160;</td>
          <td class="paramname"><em>cellGradientStencil</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Evaluate the gradient Stencil on ALL Face Cells for <a class="el" href="classmimmo_1_1MimmoObject.html" title="MimmoObject is the basic geometry container for mimmo library. ">MimmoObject</a> Volume mesh (type 2). The method assumes target mesh has interfaces already built: no check is performed in this sense.</p>
<p>The method first calculate the gradient stencil on center cells with computeFVCellGradientStencil, if not already provided by the User. Then it use these info to distribute them on interface. Face non orthogonality corrections are directly performed on the final stencil (amend and recalculate the gradient normal part to interface).</p>
<p>BEWARE: Boundary Interfaces Stencils reports the a Stencil with a Homogeneous Neumann condition on it. You need to sum the right correction to recover the proper condition.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">geo</td><td>target mesh </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cellGradientStencil</td><td>(optional) gradient stencil calculated on ALL cell centers + ghosts. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a INTERFACE data pierced vector containing the gradient stencil </dd></dl>

<p class="definition">Definition at line <a class="el" href="StencilFunctions_8cpp_source.html#l00208">208</a> of file <a class="el" href="StencilFunctions_8cpp_source.html">StencilFunctions.cpp</a>.</p>

</div>
</div>
<a id="a5c8df20fff0787ebd5a697c4a952a5a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c8df20fff0787ebd5a697c4a952a5a4">&#9670;&nbsp;</a></span>computeFVLaplacianStencil()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemimmo_1_1FVolStencil.html#aee59416f10fdab9bcd552d407fdfca92">MPVDivergenceUPtr</a> mimmo::FVolStencil::computeFVLaplacianStencil </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacemimmo_1_1FVolStencil.html#a97dd756771ac3f3f748e9dda157ba9ff">MPVGradient</a> &amp;&#160;</td>
          <td class="paramname"><em>faceGradientStencil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmimmo_1_1MimmoPiercedVector.html">MimmoPiercedVector</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>diffusivity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The method computes the Laplacian stencils on cells, once the gradient stencils on interfaces and specialized the boundary conditions on boundary interfaces are available. The resulting laplacian stencils will be available on mesh interior cells of the mesh whose interfaces are all reported in the faceGradientStencil list. Providing the right set of interfaces you can use this method both to compute laplacian stencils on the whole mesh or as updater of its subportions. Mesh Interfaces are supposed built, no control is done in such sense. Only for <a class="el" href="classmimmo_1_1MimmoObject.html" title="MimmoObject is the basic geometry container for mimmo library. ">MimmoObject</a> Volume mesh (type=2).</p>
<p>Once computed, the stencils are then divided by their ref cell volume.</p>
<p>Both faceGradientStencil and diffusivity(if any) need to be referred to the same mesh. In case of subportions updater usage, be sure diffusivity includes info on all the cells involved.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">faceGradientStencil</td><td>gradient stencil defined on effective INTERFACES (bc included, no ghost-ghost). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tolerance</td><td>threshold value used to filter out stencil items </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">diffusivity</td><td>(optional) impose a diffusivity field on center CELLS (provided also on ghosts) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="StencilFunctions_8cpp_source.html#l00500">500</a> of file <a class="el" href="StencilFunctions_8cpp_source.html">StencilFunctions.cpp</a>.</p>

</div>
</div>
<a id="a4f2b66f99a550ac2dde44405319e4114"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f2b66f99a550ac2dde44405319e4114">&#9670;&nbsp;</a></span>computeWeightsWLS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mimmo::FVolStencil::computeWeightsWLS </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; double &gt;&gt; *&#160;</td>
          <td class="paramname"><em>gweights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Internal method function -&gt; used by ComputeFVCellStencil. Given a set of points P (already translated w.r.t stencil center) and an initial guess of weights w associated to them evaluate the gradient stencil weights with a Least Squared method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">P</td><td>distance set </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>initial guess weights </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">gweights</td><td>evaluated gradient weights </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="StencilFunctions_8cpp_source.html#l00044">44</a> of file <a class="el" href="StencilFunctions_8cpp_source.html">StencilFunctions.cpp</a>.</p>

</div>
</div>
<a id="aa5199096f02206856a7aec98869bfadf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5199096f02206856a7aec98869bfadf">&#9670;&nbsp;</a></span>correctionDirichletBCFaceGradient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bitpit::StencilVector mimmo::FVolStencil::correctionDirichletBCFaceGradient </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>dirval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long &amp;&#160;</td>
          <td class="paramname"><em>ownerID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::array&lt; double, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>ownerCentroid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::array&lt; double, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>interfaceCentroid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::array&lt; double, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>interfaceNormal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>distD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bitpit::StencilVector &amp;&#160;</td>
          <td class="paramname"><em>CCellOwnerStencil</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute correction to border face gradient to recover a Dirichlet condition @ the face. Border face Dirichlet gradient stencil can be decomposed as a sum two parts:</p>
<ul>
<li>The Homogeneous Neumann part, i.e. the Gradient @ Owner cell centroid without its contribute along normal interface</li>
<li>The correction part, i.e. a finite difference estimation of the gradient stencil at the border interface, where the solution is imposed.</li>
</ul>
<p>The finite-difference correction is [(U_H - U_D) / distD] * interfaceNormal. U_D is the value of the dirichlet condition, H is a point internal at Owner Cell at distance distD form the interface centroid and on the interface normal direction, distD is a charateristic length of the Owner cell (typically the radius of the element in-sphere, incircle), U_H an estimation of field value @ H, evaluated starting from Cell Gradient stencil @ Owner.</p>
<p>Please note, the part (U_D/distD)*interfaceNormal of the correction is seen as constant by the stencil.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dirval</td><td>value of the Dirichlet Condition U_D </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ownerID</td><td>id the the ownerCell </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ownerCentroid</td><td>centroid of the owner of the BoundaryInterface </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">interfaceCentroid</td><td>centroid of the BoundaryInterface </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">interfaceNormal</td><td>normal defined on the BoundaryInterface </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">distD</td><td>charateristic length to pose the internal point H from interface Centroid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CCellOwnerStencil</td><td>cell gradient stencil referred to the owner cell </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the new corrected stencil. </dd></dl>

<p class="definition">Definition at line <a class="el" href="StencilFunctions_8cpp_source.html#l00452">452</a> of file <a class="el" href="StencilFunctions_8cpp_source.html">StencilFunctions.cpp</a>.</p>

</div>
</div>
<a id="afc151410157be4d5dc4d4bf6bbb13aa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc151410157be4d5dc4d4bf6bbb13aa1">&#9670;&nbsp;</a></span>correctionNeumannBCFaceGradient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bitpit::StencilVector mimmo::FVolStencil::correctionNeumannBCFaceGradient </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>neuval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::array&lt; double, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>interfaceNormal</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute correction to border face gradient to recover a Generic Neumann condition @ the face. Border face Generic Neumann gradient stencil can be decomposed as a sum two parts:</p>
<ul>
<li>The Homogeneous Neumann part, i.e. the Gradient @ Owner cell centroid without its contribute along normal interface</li>
<li>The correction part, i.e. the value of the directional derivative along the interface normal.</li>
</ul>
<p>Please note, this correction is "seen" as a constant part by the stencil.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">neuval</td><td>value of the Neumann Condition </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">interfaceNormal</td><td>normal defined on the BoundaryInterface </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the neumann correction. </dd></dl>

<p class="definition">Definition at line <a class="el" href="StencilFunctions_8cpp_source.html#l00416">416</a> of file <a class="el" href="StencilFunctions_8cpp_source.html">StencilFunctions.cpp</a>.</p>

</div>
</div>
<a id="a49988f33f6cfd083eb6251a621446662"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49988f33f6cfd083eb6251a621446662">&#9670;&nbsp;</a></span>updateFVFaceGradientStencil() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemimmo_1_1FVolStencil.html#adb0e8db7d8924009c16d9034c706805f">MPVGradientUPtr</a> mimmo::FVolStencil::updateFVFaceGradientStencil </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmimmo_1_1MimmoObject.html">MimmoObject</a> &amp;&#160;</td>
          <td class="paramname"><em>geo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; long &gt; &amp;&#160;</td>
          <td class="paramname"><em>list</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Re-evaluate the gradient Stencil on Face Cells for a selected list of <a class="el" href="classmimmo_1_1MimmoObject.html" title="MimmoObject is the basic geometry container for mimmo library. ">MimmoObject</a> Volume mesh (type 2) cells. The method assumes target mesh has interfaces already built: no check is performed in this sense.</p>
<p>The method first re-evaluate the center cell gradient stencil on a selected list of cells provided by the User Then it use these info to re-evaluate stencils on all interfaces related to the cells of the list. Face non orthogonality corrections are directly performed on the final stencil (amend and recalculate the gradient normal part to interface).</p>
<p>BEWARE: During this update, Boundary Interfaces Stencils (if any) reports the a Stencil with a Homogeneous Neumann condition on it. You need to sum the right correction to recover the proper condition.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">geo</td><td>target mesh </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">list</td><td>of cell IDs you need to update. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a INTERFACE data pierced vector containing gradient stencils at all interfaces relative to the selected cells. </dd></dl>

<p class="definition">Definition at line <a class="el" href="StencilFunctions_8cpp_source.html#l00241">241</a> of file <a class="el" href="StencilFunctions_8cpp_source.html">StencilFunctions.cpp</a>.</p>

</div>
</div>
<a id="abb978fddb1717c411f7be2727217580e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb978fddb1717c411f7be2727217580e">&#9670;&nbsp;</a></span>updateFVFaceGradientStencil() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacemimmo_1_1FVolStencil.html#adb0e8db7d8924009c16d9034c706805f">MPVGradientUPtr</a> mimmo::FVolStencil::updateFVFaceGradientStencil </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmimmo_1_1MimmoObject.html">MimmoObject</a> &amp;&#160;</td>
          <td class="paramname"><em>geo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacemimmo_1_1FVolStencil.html#a97dd756771ac3f3f748e9dda157ba9ff">MPVGradient</a> &amp;&#160;</td>
          <td class="paramname"><em>cellGradientStencil</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Re-evaluate the gradient Stencil on Face Cells for a selected list of <a class="el" href="classmimmo_1_1MimmoObject.html" title="MimmoObject is the basic geometry container for mimmo library. ">MimmoObject</a> Volume mesh (type 2) cells. The method assumes target mesh has interfaces already built: no check is performed in this sense.</p>
<p>The method use the already evaluated center cell gradient stencil on a selected list of cells provided by the User Then it re-evaluates stencils on all interfaces related to the cells of the list. Face non orthogonality corrections are directly performed on the final stencil (amend and recalculate the gradient normal part to interface).</p>
<p>BEWARE: During this update, Boundary Interfaces Stencils (if any) reports the a Stencil with a Homogeneous Neumann condition on it. You need to sum the right correction to recover the proper condition.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">geo</td><td>target mesh </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cellGradientStencil</td><td>MPV of Center Cell Gradient stencils involved into update. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a INTERFACE data pierced vector containing gradient stencils at all interfaces relative to the selected cells. </dd></dl>

<p class="definition">Definition at line <a class="el" href="StencilFunctions_8cpp_source.html#l00263">263</a> of file <a class="el" href="StencilFunctions_8cpp_source.html">StencilFunctions.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->

</div>
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<address class="footer"><small>
Generated on Thu Oct 24 2019 11:36:11 for mimmo by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
    <div id="footer" >
        <div class="middle">
            <div class="box-wrapper">
                <div class="box mimmo">
                    <p>
                    <strong><a href="/mimmo">mimmo</a></strong><br />
                    <a href="/mimmo/overview">Overview</a><br />
                    <a href="/mimmo/downloads">Downloads</a>
                    </p>
                </div>
                <div class="box optimad">
                    <p>
                    <strong><a href="http://www.optimad.it">OPTIMAD Engineering Srl</a></strong><br />
                    <a href="http://www.optimad.it/corporate/spin-off/">About</a><br />
                    <a href="http://www.optimad.it/contact-us/">Contact us</a><br />
                    <a href="mailto:info@optimad.it">info@optimad.it</a>
                    </p>
                </div>
                <div class="box address">
                    <p>
                    <strong>Address</strong><br />
                    Via Giacinto Collegno 18<br />
                    10143 Torino<br />
                    Italy
                    </p>
                </div>
                <div class="box info">
                    <p>
                    <strong>Info</strong><br />
                    Capitale Sociale € 10.000,00 i.v.<br />
                    C.F. / P.Iva 09359170017<br />
                    Iscr. Reg. Impr. Torino - R.E.A. TO-1045102
                    </p>
                </div>
            </div>
        </div>
        <div class="legal">
                    <p>
                    © 2016-2017 OPTIMAD Engineering Srl -
                    <a href="/mimmo/privacy.html">Privacy Policy</a>
                    </p>
        </div>
    </div>
</div>
</body>
</html>
